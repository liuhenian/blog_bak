---
title: 常见并发服务器设计
date: 2020-04-23 09:21:11
tags: web服务器
---

浏览器资源请求分为

1、静态资源请求

   html， js，css，img 等

2、动态资源请求

  jsp，php等

 

web 服务器可以分为 http 服务器--> 处理静态资源请求（apache和nginx）也称为前端服务器

​                 应用服务器--> 处理动态资源请求（jboss/tomcat） 后端服务器 处理实际商业逻辑

二、缓存处理

1）访问网站先从前端缓存获取数据，前端服务器中可以做静态页面缓存，可以减少对web应用服务器的请求

2）对于动态资源请求，可以做动态资源请求中相对静态的资源的缓存，（ESI）

3）对数据库的数据做本地数据的缓存，减少对数据库的查询。使用数据库，也可以减少对文件系统的i/o操作

三、集群的读写分离

  web 服务器分为前端服务器和应用服务器，需要处理负载均衡。

  读的操作》写的操作

  写一般到主库，读一般到从库，写的时候需要同步，（replication操作）

四、负载均衡

  1、前端负载均衡，

​    dns负载均衡，在dns服务器中，对不同地址配置同一个名字，访问同一个名字，得到不同的地址（内部算法）。

  2、反向代理

​    多个客户发送请求到代理服务器，代理服务器将请求均匀的转发给多台内部web服务器，从而达到负载均衡的目的

   标准的代理方式：客户使用代理访问多个外部web服务器。

  3、基于NAT的负载均衡技术

 

五、CDN（内容分发网络）、分布式缓存，分库分表

1、并发量比较打的时候，锁竞争比较激烈。

 

 

六、分库

1、垂直分区

将一个数据库的数据，根据内容不同，进行种类划分（用户数据，业务数据，基础数据）

然后分成多个数据库（分完之后，单个数据库中的某个表可能依然很大）

![用 戸 物  用 戸 数  並 数 据  並 勢 数 据  基 を 数 据  基 を 数 据 ](F:\picture\Typora\clip_image001.png)

2、水平分区

后面三个数据库中所有数据的组合，变为同一个数据库中的数据，因此，在访问数据的时候，需要增加一个DAL层，保证可以访问正确的数据库。

![口 水 平 分 区 (F:\picture\Typora\clip_image002.png)  用 户 獭 据  业 务 据  基 毗 麯  焦 户 锯  用 户 獭 据  用 户 獭 据  业 务 獭 据  业 务 駭 据  业 务 据  基 据  基 毗 麯 露  基 据 ](file:///C:/Users/刘鹤年/AppData/Local/Temp/msohtmlclip1/02/clip_image002.png)

 

七、多数据中心，分布式存储于计算

对一致性要求不高的数据，没有必要保存在关系型数据库中。

关系型数据库注重，数据的一致性

nosql数据库，注重数据访问的高并发。

技术点：

1、DFS分布式文件系统

2、key-value DB

3、map/reduce分布式计算框架

![の 冖 、 ” 。 に / 工 ザ 。  ア 0 ~ ま 、 第 け を 0 れ 0 石 を  工 0 , れ ぞ •B な ぬ , ′  工 を 0 ア は ど を 0 れ 0 石 を  工 0 , 気 イ ・ •3 は に ~ れ 0 に  ア 0 , に ア は を 0 0 石 を  工 0 イ 'a な , に  石  ロ  基 于 分 布 式 文 件 系 統 汁 算 架 建 立 数 据 中 心 、  , 0 イ ](F:\picture\Typora\clip_image003.png)

 

下面就是大型网站的总的架构图

![の , 0 、 ” を , ( / 工 わ 霻 ル  0 砿 せ ア “ を 030 を  ア , 0 ~ ま ア 、 電 け を C “ 0 石 を  工 0 , れ の な ぬ , に  工 YO ア “ ど を 0 “ 0 石 を  工 0 は イ ・ は ぬ , に  の な い イ を に に イ ・ の  基 于 分 市 式 文 件 系 i 十 算 架 建 立 数 据 中 心 、  1 ロ ー  工 ~ , 霍 “ を 0 “ 0 石 を  工 0 イ •B ぬ , に ](F:\picture\Typora\clip_image004.png)